sum(rle(sample(payout, n, replace=TRUE, prob = probability))$lengths > 45
sum(rle(sample(payout, n, replace=TRUE, prob = probability))$lengths > 45)
sum(rle(sample(payout, 1000, replace=TRUE, prob = probability))$lengths > 45)
rle(sample(payout, 1000, replace=TRUE, prob = probability))$lengths
rle(sample(payout, 1000, replace=TRUE, prob = probability))$lengths
payout
prob
probability
sample(payout, 10, probability, replace=T)
sample(payout, 10, probability, replace=T)
sample(payout, 10, probability, replace=T)
sample(payout, 10, probability, replace=T)
sample(payout, 10, probability, replace=T)
sample(payout, 10, probability, replace=T)
sample(payout, 10, probability, replace=T)
sample(payout, 10, probability, replace=T)
sample(payout, 1000, probability, replace=T)
sample(payout, 1000, probability, replace=T)
sample(payout, 1000, probability, replace=T)
rle(sample(payout, 1000, replace=TRUE, prob = probability))$lengths
rle(sample(payout, 1000, replace=TRUE, prob = probability))$lengths
hist(rle(sample(payout, 1000, replace=TRUE, prob = probability))$lengths)
rle(sample(payout, 1000, replace=TRUE, prob = probability))$lengths
hist(rle(sample(payout, 1000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
hist(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths)
rle(sample(payout, 1000, replace=TRUE, prob = probability))$lengths
rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths
rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
lapply(sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44))
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
lapply(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths, sum)
lapply(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths, sum)
lapply(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths, mean)
rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths) > 44
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths) > 44
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)
replicate(sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44), 10)
replicate(sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44), 10)
replicate(sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44), 10)
replicate(sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44), 10)
replicate(sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44))
?replicate()
replicate(10, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44))
replicate(10, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44))
replicate(10, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44))
replicate(100, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44))
replicate(100, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44))
replicate(1000, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44))
hist(replicate(1000, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)))
replicate(1000, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44))
replicate(1000, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)) == 1
n = 1000
sum(replicate(n, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44)) == 1) / n
n = 100
sum(replicate(n, sum(rle(sample(payout, 30000, replace=TRUE, prob = probability))$lengths > 44)) == 1) / n
sum(replicate(n, sum(rle(sample(payout, 50000, replace=TRUE, prob = probability))$lengths > 44)) == 1) / n
sum(replicate(n, sum(rle(sample(payout, 50000, replace=TRUE, prob = probability))$lengths > 40)) == 1) / n
sum(replicate(n, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 40)) == 1) / n
n = 100
replicate(1000, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 44))
sum(replicate(n, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 40)) == 0) / n
n = 100
sum(replicate(n, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 40)) == 0) / n
sum(replicate(n, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 40)) == 0) / n
sum(replicate(n, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 40)) == 0) / n
sum(replicate(n, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 40)) == 0) / n
sum(replicate(n, sum(rle(sample(payout, 20000, replace=TRUE, prob = probability))$lengths > 40)) == 0) / n
sum(replicate(n, sum(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths > 40)) == 0) / n
n = 100
sum(replicate(n, sum(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths > 40)) == 0) / n
n = 1000
sum(replicate(n, sum(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths > 40)) == 0) / n
payout <- c(0, 1)
probability = c(0.15, 0.85)
games <- 20000
sample(payout, games, replace=TRUE, prob = probability)
rle(sample(payout, games, replace=TRUE, prob = probability))
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
sample(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > 44)
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > 44)
payout <- c(0, 1)
probability = c(0.15, 0.85)
games <- 20000
replicates <- 1000
streak <- 44
sample(payout, games, replace=TRUE, prob = probability)
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
replicate(replicates, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak))
sum(replicate(n, sum(rle(sample(payout, 10000, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#
sample(payout, games, replace=TRUE, prob = probability)
#For these games, calculate the length of each win streak
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
#Calculate
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Calculate the number of winning streaks linger than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Do all of the above simultaneously 1000 times
replicate(replicates, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak))
#Calculate the average number of times winning streaks were longer than 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#Calculate the average number of times winning streaks were longer than 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
chess_winstreak <- function(winloss = c(0,1), probability = c(0.15, 0.85), streak = 44, games = 20000, replicates = 1000) {
set.seed(1)
sample(payout, games, replace=TRUE, prob = probability)
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
replicate(replicates, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak))
output <- sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
return(output)
}
chess_winstreak()
chess_winstreak
chess_winstreak()
chess_winstreak(streak = 15)
chess_winstreak(streak = 15)
chess_winstreak(streak = 100)
replicate(replicates, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak))
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)''
max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths))
hist(replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)
replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths))
#Prettier histogram
chess_data <- as_tibble(replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data
#Prettier histogram
chess_data <- as_tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data
chess_data %>% ggplot(aes(x)) +
geom_histogram(color = "grey", fill = "lightblue") +
theme_classic()
chess_data %>% ggplot(aes(x)) +
geom_histogram(color = "grey", fill = "lightblue") +
theme_bw()
chess_data %>% ggplot(aes(x)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=percent) +
theme_bw()
chess_data %>% ggplot(aes(x)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1L))
chess_data %>% ggplot(aes(x)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
theme_bw()
theme_bw(()
chess_data %>% ggplot(aes(x)) +
geom_histogram(color = "grey", fill = "lightblue") +
theme_bw()
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "grey", fill = "lightblue") +
theme_bw
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "grey", fill = "lightblue") +
theme_bw()
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "grey", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
theme_bw()
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "grey", fill = "blue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
theme_bw()
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "grey", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
theme_bw()
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
theme_bw()
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Winning streak length (number of games)")
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Winning streak length (number of games)") +
theme_bw()
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Winning streak length (number of games)")
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Winning streak length (number of games)")
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Winning streak length (number of games)",
title = "20k games played, 300 elo difference")
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played, 300 elo difference")
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
dev.off()
rbinom(1000, 5, 0.5)
rbinom(1000, 5, 0.15)
rbinom(1000, 5, 0.85)
?rbinom
rbinom(10, 5, 0.85)
rbinom(10, 1, 0.85)
rbinom(10, 1, 0.85)
rbinom(1000, 1000, 0.85)
#Loss = 0, Win = 1
payout <- c(0, 1)
#Probability for Loss = 15 %, probability for Win = 85 %
probability <- c(0.15, 0.85)
#Streak length of interest
streak <- 44
#Number of games played
games <- 20000
#How many times we iterate over the simulation
replicates <- 1000
#Simulate sample of 20000 games such that in each game, we win 85% of the time and lose 15% of the time
#Result: list of 0s and 1s for each game
sample(payout, games, replace=TRUE, prob = probability)
#For these games, calculate the length of each win streak. Result: list of winnin streak lengths across all 20000 games
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
#Calculate the number of winning streaks linger than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Do all of the above simultaneously 1000 times
replicate(replicates, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak))
#Calculate the average number of times winning streaks were longer than 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#Histogram of MAX winstreak lengths
hist(replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
#Probability for Loss = 15 %, probability for Win = 85 %
probability <- c(0.30, 0.70)
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
#Probability for Loss = 15 %, probability for Win = 85 %
probability <- c(0.20, 0.80)
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
#Probability for Loss = 15 %, probability for Win = 85 %
probability <- c(0.15, 0.85)
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
#Simulate sample of 20000 games such that in each game, we win 85% of the time and lose 15% of the time
#Result: list of 0s and 1s for each game
sample(payout, games, replace=TRUE, prob = probability)
#For these games, calculate the length of each win streak. Result: list of winning streak lengths across all 20000 games
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
#Calculate the number of winning streaks linger than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Do all of the above simultaneously 1000 times
replicate(replicates, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak))
#Calculate the average number of times winning streaks were longer than 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#Histogram of MAX winstreak lengths
hist(replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
#Simulate sample of 20000 games such that in each game, we win 85% of the time and lose 15% of the time
#Result: list of 0s and 1s for each game
sample(payout, games, replace=TRUE, prob = probability)
#For these games, calculate the length of each win streak. Result: list of winning streak lengths across all 20000 games
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
set.seed(1)
#Loss = 0, Win = 1
payout <- c(0, 1)
#Probability for Loss = 15 %, probability for Win = 85 %
probability <- c(0.15, 0.85)
#Streak length of interest
streak <- 44
#Number of games played
games <- 20000
#How many times we iterate over the simulation
replicates <- 1000
#Simulate sample of 20000 games such that in each game, we win 85% of the time and lose 15% of the time
#Result: list of 0s and 1s for each game
sample(payout, games, replace=TRUE, prob = probability)
#For these games, calculate the length of each win streak. Result: list of winning streak lengths across all 20000 games
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
#Simulate sample of 20000 games such that in each game, we win 85% of the time and lose 15% of the time
#Result: list of 0s and 1s for each game
sample(payout, games, replace=TRUE, prob = probability)
#For these games, calculate the length of each win streak. Result: list of winning streak lengths across all 20000 games
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
#For these games, calculate the length of each win streak. Result: list of winning streak lengths across all 20000 games
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
#Calculate the number of winning streaks linger than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Calculate the number of winning streaks linger than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Calculate the number of winning streaks linger than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Calculate the number of winning streaks linger than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Calculate the number of winning streaks linger than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Calculate the number of winning streaks linger than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Calculate the number of winning streaks linger than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Do all of the above simultaneously 1000 times
replicate(replicates, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak))
#Calculate the average number of times winning streaks were longer than 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#Calculate the number of times there were 0 winning streaks of at least 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#Histogram of MAX winstreak lengths
hist(replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
dev.off()
#Histogram of MAX winstreak lengths
hist(replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion of winning streaks", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
#Calculate the number of times there were 0 winning streaks of at least 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#Calculate the number of times there were 0 winning streaks of at least 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#Loss = 0, Win = 1
payout <- c(0, 1)
#Probability for Loss = 15 %, probability for Win = 85 %
probability <- c(0.15, 0.85)
#Streak length of interest
streak <- 44
#Number of games played
games <- 50000
#How many times we iterate over the simulation
replicates <- 1000
#Simulate sample of 20000 games such that in each game, we win 85% of the time and lose 15% of the time
#Result: list of 0s and 1s for each game
sample(payout, games, replace=TRUE, prob = probability)
#For these games, calculate the length of each win streak. Result: list of winning streak lengths across all 20000 games
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
#Calculate the number of winning streaks longer than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Do all of the above simultaneously 1000 times
replicate(replicates, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak))
#Calculate the number of times there were 0 winning streaks of at least 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#Histogram of MAX winstreak lengths
hist(replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
#Calculate the number of times there were 0 winning streaks of at least 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#Prettier histogram
chess_data <- tibble(x = replicate(replicates, max(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths)))
chess_data %>% ggplot(aes(x)) +
geom_histogram(aes(y=..density..), color = "black", fill = "lightblue") +
scale_y_continuous(labels = scales::label_percent(accuracy = 1L)) +
labs(y = "Proportion", x = "Maximum winning streak length (number of games)",
title = "20k games played (simulated 1000 times), 300 elo difference")
#For these games, calculate the length of each win streak. Result: list of winning streak lengths across all 20000 games
rle(sample(payout, games, replace=TRUE, prob = probability))$lengths
#Calculate the number of winning streaks longer than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
#Do all of the above simultaneously 1000 times
replicate(replicates, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak))
#Calculate the number of times there were 0 winning streaks of at least 44 games, express it as a probability
sum(replicate(n, sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)) == 0) / n
#Calculate the number of winning streaks longer than 44
sum(rle(sample(payout, games, replace=TRUE, prob = probability))$lengths > streak)
?rle?
?rle
