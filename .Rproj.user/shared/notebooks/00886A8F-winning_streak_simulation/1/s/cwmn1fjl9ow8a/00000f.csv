"0","library(tidyverse)"
"0",""
"0","#Loss = 0, Win = 1"
"0","result <- c(0, 1)"
"0",""
"0","#Probability for Loss = 15 %, probability for Win = 85 % (roughly approximating an elo-rating difference of 300)"
"0","probability <- c(0.35, 0.65)"
"0",""
"0","#Streak length of interest"
"0","streak <- 44"
"0",""
"0","#Number of games played"
"0","games <- 50000"
"0",""
"0","#How many times we iterate over the simulation"
"0","replicates <- 1000"
"0",""
"0","#Simulate sample of 50000 games such that in each game, we win 85% of the time and lose 15% of the time"
"0","#Result: list of 0s and 1s for each game (display first 30)"
"0","set.seed(1)"
"0","head(sample(result, games, replace=TRUE, prob = probability), 30)"
"1"," [1]"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 0"
"1"," 1"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 0"
"1"," 1"
"1"," 0"
"1"," 1"
"1"," 0"
"1"," 0"
"1"," 1"
"1"," 0"
"1"," 0"
"1"," 1"
"1"," 0"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 0"
"1"," 1"
"1","
"
"0","#For these games, calculate the length of each win streak. "
"0","#Result: list of winning streak lengths across all 50000 games (display first 30)"
"0","set.seed(1)"
"0","run_length_all <- rle(sample(result, games, replace=TRUE, prob = probability))"
"0","run_length_wins <- run_length_all$lengths[run_length_all$values==1]"
"0","run_length_losses <- run_length_all$lengths[run_length_all$values==0] #to be used later (not yet analysed)"
"0","head(run_length_wins, 30)"
"1"," [1]"
"1"," 3"
"1"," 1"
"1"," 4"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 5"
"1"," 5"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 2"
"1"," 2"
"1"," 1"
"1"," 6"
"1"," 1"
"1"," 3"
"1"," 2"
"1"," 1"
"1"," 1"
"1"," 3"
"1"," 1"
"1"," 1"
"1"," 2"
"1"," 1"
"1"," 6"
"1"," 2"
"1"," 1"
"1"," 2"
"1","
"
"0","#Calculate the number of winning streaks longer than 44"
"0","sum(run_length_wins > streak)"
"1","[1]"
"1"," 0"
"1","
"
"0","#Calculate the number of winning streaks longer than 44 1000 times, obtain mean and standard deviation"
"0","set.seed(1)"
"0","run_length_wins_repl <- replicate(replicates, with(rle(sample(result, games, replace=TRUE, prob = probability)), sum(lengths[values==1] > streak)))"
"0","head(run_length_wins_repl, 30)"
"1"," [1]"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1","
"
"0","mean(run_length_wins_repl)"
"1","[1]"
"1"," 0"
"1","
"
"0","sd(run_length_wins_repl)"
"1","[1]"
"1"," 0"
"1","
"
"0","#Calculate the number of times there were 0 winning streaks of at least 44 games, express it as a probability"
"0","set.seed(1)"
"0","sum(run_length_wins_repl == 0) / replicates"
"1","[1]"
"1"," 1"
"1","
"
